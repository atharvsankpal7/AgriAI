"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[451],{4451:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});a(3508),a(4980);var s=a(5559),n=a(2791),o=a(7689),r=a(3832),c=a(184);const l=()=>{const e=(0,n.useContext)(s.Z),t=(0,o.s0)(),[a,l]=r.ZP.useMessage(),i="http://localhost:5000/api/",{notes:d,setNotes:m}=e,[u,g]=(0,n.useState)(null),[h,p]=(0,n.useState)(!1),[f,x]=(0,n.useState)(null),k=(0,n.useRef)(null);(0,n.useEffect)((()=>{localStorage.getItem("token")?y():t("/login")}),[]),(0,n.useEffect)((()=>()=>{f&&f.getTracks().forEach((e=>{e.stop()}))}),[f]);const y=async()=>{try{const e=await fetch("".concat(i,"notes/getallnotes"),{method:"GET",headers:{"auth-token":localStorage.getItem("token")}});if(!e.ok)return;const t=await e.json();m(t)}catch(e){console.error("Error fetching notes:",e)}};return(0,c.jsxs)("div",{className:" pt-3 pb-3 ",children:[l,(0,c.jsxs)("div",{className:"container d-flex flex-column align-items-center justify-content-center text-xxl-center backgroundImage w-75",children:[(0,c.jsxs)("h2",{className:"text-center fs-1 font-monospace pt-3 ",style:{color:"red"},children:["Welcome back,"," ",localStorage.getItem("username")?localStorage.getItem("username"):"username"," ","!!!"]}),(0,c.jsxs)("div",{className:"image-upload-container  ",children:[(0,c.jsxs)("div",{className:"img ",children:[(0,c.jsx)("input",{type:"file",accept:"image/*",name:"",id:"image_upload",hidden:!0,onChange:e=>{try{const t=e.target.files[0],a=new FileReader;a.onloadend=()=>{g(a.result)},a.readAsDataURL(t)}catch(t){console.log(t)}}}),(0,c.jsx)("label",{htmlFor:"image_upload",className:"w-100 h-100 d-flex align-items-center justify-content-center",children:null===u?(0,c.jsx)("img",{src:"upload.png",alt:"Browse Images",className:"w-50 h-100"}):u?(0,c.jsx)("img",{src:u,alt:"selectedImage",className:"w-100 h-100"}):(0,c.jsx)("video",{ref:k,autoPlay:!0,muted:!0,className:"w-100 h-100"})})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("button",{className:"btn btn-outline-dark border-2 my-3 text-dark-emphasis fs-4",onClick:async()=>{g(0);try{const e=await navigator.mediaDevices.getUserMedia({video:!0});x(e),k.current&&(k.current.srcObject=e)}catch(e){console.error("Error accessing camera:",e)}},children:"Open Camera"}),(0,c.jsx)("button",{className:"btn btn-outline-dark border-2 my-3 text-dark-emphasis fs-4",onClick:()=>{if(k.current){const e=document.createElement("canvas"),t=e.getContext("2d");e.width=k.current.videoWidth,e.height=k.current.videoHeight,t.drawImage(k.current,0,0,e.width,e.height);const a=e.toDataURL("image/png");g(a),f&&f.getTracks().forEach((e=>{e.stop()}))}},children:"Capture Image"})]}),(0,c.jsx)("button",{className:"btn btn-outline-dark border-2 w-100 my-3 text-dark-emphasis fs-4",onClick:async()=>{p(!0);try{a.open({type:"loading",content:"Uploading Image...",duration:0});const e=await fetch("".concat(i,"notes/addnote"),{method:"POST",headers:{"Content-Type":"application/json","auth-token":localStorage.getItem("token")},body:JSON.stringify({baseImage:u})});if(!e.ok)return a.destroy(),a.error("Error Uploading Image"),void p(!1);const t=await e.json(),s=d;s.push(t),m(s),g(null),y(),a.destroy(),a.success("Successfully uploaded image"),p(!1)}catch(e){a.destroy(),a.error("Error Uploading Image"),p(!1),console.error("Error Uploading notes:",e)}},disabled:!u||h,children:"Upload Image"})]})]})]})]})}},3508:()=>{},4980:()=>{}}]);
//# sourceMappingURL=451.d77698dd.chunk.js.map